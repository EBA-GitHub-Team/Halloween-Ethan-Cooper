<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Phantom Phactory: Tickets</title>
		<link href="styles.css" rel="stylesheet">
        <link rel="shortcut icon" href="files/favicon.ico">
		<meta charset="utf-8">
		<script src="mobileCheck.js"></script>
        <script src="formSubmit.js"></script>
	</head>
	
	<body>
        <div id="header">
            <a href="index.html"><img src="files/logo.png" alt="Logo"></a>
        </div>
        
        <div id="nav">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="attractions.html">Attractions</a></li>
                <li><a href="tickets.html">Tickets</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="newsletter.html">Newsletter</a></li>
            </ul>
        </div>
        
        <div id="main">
			<h2>Review <strong>Your Order</strong>!</h2>

            <p>Please confirm that the following information is correct:</p>
            <p>First Ticket Cost: <strong>$99.99</strong></p>
            <p>Each Additional Ticket: <strong>$49.99</strong></p>
            <p>Your Order: <strong><span id="tickets">0</span> Ticket(s)</strong></p>
            <p>Subtotal: <strong>$<span id="subtotal"></span></strong></p>
            <p>Tax: <strong>$<span id="tax"></span></strong></p>
            <p>Website Fee: <strong>$<span id="fee"></span></strong></p>
            <p>Total: <strong>$<span id="total"></span></strong></p>
            <button onclick="complete()">Complete Purchase</button>
        </div>
        
        <div id="footer">
            <p>Property of EthanBlaisAlarms<br>&copy; Copyright EthanBlaisAlarms 2023<br>All Rights Reserved</p>
            <p><a href="copyright.html">Click for copyright information.</a></p>
        </div>

        <script>
			const urlParams = new URLSearchParams(window.location.search);
            let amount = parseInt(Number(urlParams.get('quantity')));
            if (isNaN(amount)) {
                alert('Your order cannot be completed: Cannot parse quantity.\nYou will be redirected to the purchase page.');
                document.location = 'tickets.html';
                throw 'Cannot parse quantity';
            }
            if (amount < 1) {
                alert('Your order cannot be completed: Minimum purchase is 1 ticket.\nYou will be redirected to the purchase page.');
                document.location = 'tickets.html';
                throw 'Minimum purchase is 1 ticket';
            }
            if (amount > 100) {
                alert('Your order cannot be completed: Maximum purchase is 100 tickets.\nYou will be redirected to the purchase page.');
                document.location = 'tickets.html';
                throw 'Maximum purchase is 100 tickets';
            }
            document.getElementById('tickets').innerHTML = amount;
            let subtotal = 99.99 + (amount - 1) * 49.99;
            let tax = Math.round(subtotal * 8) / 100;
            let fee = Math.round(subtotal * 3) / 100;
            document.getElementById('subtotal').innerHTML = subtotal;
            document.getElementById('tax').innerHTML = tax;
            document.getElementById('fee').innerHTML = fee;
            document.getElementById('total').innerHTML = subtotal + tax + fee;
            function complete() {
                document.location = 'cardError.html';
            }
        </script>
	</body>
</html>